import { SlashCommandBuilder, PermissionFlagsBits } from 'discord.js'; import { prisma } from '../lib/db.js'; export const data=new SlashCommandBuilder().setName('release').setDescription('Release a submissive').addUserOption(o=>o.setName('submissive').setDescription('User to release').setRequired(true)).setDefaultMemberPermissions(PermissionFlagsBits.ManageGuild); export async function execute(i){ const dom=i.user; const sub=i.options.getUser('submissive',true); const rel=await prisma.relationship.findFirst({ where:{ guildId:i.guildId!, domId:dom.id, subId:sub.id, status:'active'} }); if(!rel) return i.reply({ content:'No active claim found.',ephemeral:true}); await prisma.relationship.update({ where:{ id:rel.id }, data:{ status:'released' } }); await i.reply({ content:`Chains unfastened. ${sub} is released by ${dom}.`}); }
