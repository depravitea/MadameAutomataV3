import { SlashCommandBuilder } from 'discord.js'; import { prisma } from '../lib/db.js'; export const data=new SlashCommandBuilder().setName('riddle-guess').setDescription('Guess the active riddle').addStringOption(o=>o.setName('answer').setDescription('Your guess').setRequired(true)); export async function execute(i){ const r=await prisma.riddle.findFirst({ where:{ guildId:i.guildId!, channelId:i.channelId, active:true } }); if(!r) return i.reply({ content:'No active riddle here.',ephemeral:true}); const a=i.options.getString('answer',true).trim().toLowerCase(); if(a===r.answer.toLowerCase()){ await prisma.riddle.update({ where:{ id:r.id }, data:{ active:false } }); await i.reply({ content:'Correct. The echoes approve.'}); } else { await i.reply({ content:'Not quite. The walls remain silent.'}); } }
